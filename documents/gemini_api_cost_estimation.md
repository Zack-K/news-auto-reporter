# Gemini API トークン消費量とコスト想定

## 結論

AIニュースレポート自動生成システムにおけるGemini 2.5 Flash APIの利用コストは、非常に低く抑えられることが試算により明らかになりました。RSSフィードの数が増加しても、1日あたりの総料金はごくわずかです。

特に、**日本語記事のみに処理を絞ることで、海外記事の翻訳プロセスが不要となり、トークン消費量とそれに伴うコストを大幅に節約できます。** 例えば、RSSフィードが10個、合計200記事を処理する場合でも、海外記事を含むケースでは1日あたり約$0.0184（約¥2.76）ですが、日本語記事のみのケースでは約$0.0064（約¥0.96）となり、約65%のコスト削減が期待できます。

*   RSSフィードの数が増えるにつれて、Gemini APIのトークン消費量と利用料は比例して増加します。
*   この試算は、各RSSフィードから選定される記事が最大3記事であるという前提に基づいています。選定ロジックが変更され、より多くの記事が選定される場合、出力トークン数が増加し、それに伴い総トークン数も増加します。
*   `generate_image_keywords_with_gemini` と `generate_closing_comment_with_gemini` は、選定された記事の数に依存するため、RSSフィードの数が増えても、選定される記事の数が変わらなければ、これらの処理によるトークン消費は大きく変わりません。

本試算は、Gemini APIの利用料を把握し、運用戦略を検討する上で有用な目安となるでしょう。

## はじめに

本ドキュメントでは、AIニュースレポート自動生成システムにおけるGemini 2.5 Flash APIのトークン消費量とコストを試算します。試算は、RSSフィードの数が増加した場合を想定し、以下の2つのケースで検討します。

1.  **海外記事10記事 + 日本語記事10記事**: 各RSSフィードから海外記事10記事、日本語記事10記事を取得する前提。
2.  **日本語記事10記事のみ**: 各RSSフィードから日本語記事10記事のみを取得する前提。

### 試算の前提条件

*   **Gemini モデル**: Gemini 2.5 Flash
*   **Gemini API 料金**:
    *   入力トークン: $0.15 / 100万トークン
    *   出力トークン: $0.60 / 100万トークン
*   **為替レート**: $1 = ¥150
*   **1記事あたりの平均文字数**:
    *   海外記事: 2000文字
    *   日本語記事: 2000文字
*   **翻訳による文字数変化**: 英語から日本語への翻訳で1.5倍に増加（海外記事の要約時のみ）
*   **日本語のトークン換算**: 4文字 = 1トークン

## LLM処理ごとのトークン消費量 (1つのRSSフィードあたり)

### ケース1: 海外記事10記事 + 日本語記事10記事

1つのRSSフィード（海外記事10 + 日本語記事10）あたりの各LLM処理におけるトークン消費量を以下に示します。

#### 1. `translate_and_summarize_with_gemini` (海外記事10のみに適用)

*   **入力文字数**: 20,500文字 → **5,125トークン**
*   **出力文字数**: 3,000文字 → **750トークン**

#### 2. `categorize_article_with_gemini` (海外記事10 + 日本語記事10に適用)

*   **入力文字数**: 9,000文字 → **2,250トークン**
*   **出力文字数**: 400文字 → **100トークン**

#### 3. `select_and_summarize_articles_with_gemini` (海外記事10 + 日本語記事10から選定された記事に適用)

*   **入力文字数**: 5,500文字 → **1,375トークン**
*   **出力文字数**: 1,410文字 → **353トークン**

#### 4. `generate_image_keywords_with_gemini` (選定された最初の1記事に適用)

*   **入力文字数**: 470文字 → **118トークン**
*   **出力文字数**: 50文字 → **13トークン**

#### 5. `generate_closing_comment_with_gemini` (選定された記事のリストに基づいて適用)

*   **入力文字数**: 510文字 → **128トークン**
*   **出力文字数**: 100文字 → **25トークン**

#### 1つのRSSフィードあたりの合計トークン数

*   **総入力トークン**: 8,996トークン
*   **総出力トークン**: 1,241トークン
*   **合計トークン**: **10,237トークン**

### ケース2: 日本語記事10記事のみ

1つのRSSフィード（日本語記事10のみ）あたりの各LLM処理におけるトークン消費量を以下に示します。

#### 1. `translate_and_summarize_with_gemini` (日本語記事のためスキップ)

*   **トークン消費**: **0トークン**

#### 2. `categorize_article_with_gemini` (日本語記事10に適用)

*   **入力文字数**: 4,500文字 → **1,125トークン**
*   **出力文字数**: 200文字 → **50トークン**

#### 3. `select_and_summarize_articles_with_gemini` (日本語記事10から選定された記事に適用)

*   **入力文字数**: 3,000文字 → **750トークン**
*   **出力文字数**: 1,410文字 → **353トークン**

#### 4. `generate_image_keywords_with_gemini` (選定された最初の1記事に適用)

*   **入力文字数**: 470文字 → **118トークン**
*   **出力文字数**: 50文字 → **13トークン**

#### 5. `generate_closing_comment_with_gemini` (選定された記事のリストに基づいて適用)

*   **入力文字数**: 510文字 → **128トークン**
*   **出力文字数**: 100文字 → **25トークン**

#### 1つのRSSフィードあたりの合計トークン数

*   **総入力トークン**: 2,121トークン
*   **総出力トークン**: 441トークン
*   **合計トークン**: **2,562トークン**

## RSSフィード数ごとのトークン数と料金試算

### ケース1: 海外記事10記事 + 日本語記事10記事

| RSSフィード数 | 取得記事数 (海外/日本語) | 総入力トークン | 総出力トークン | 総トークン | 1日あたり総料金 (概算) | 月額総料金 (概算) |
| :------------ | :----------------------- | :------------- | :------------- | :--------- | :----------------------- | :---------------- |
| 3             | 30/30                    | 26,988         | 3,723          | 30,711     | $0.0055 (約 ¥825)        | $0.165 (約 ¥2,475) |
| 5             | 50/50                    | 44,980         | 6,205          | 51,185     | $0.0092 (約 ¥1,380)        | $0.276 (約 ¥4,140) |
| 10            | 100/100                  | 89,960         | 12,410         | 102,370    | $0.0184 (約 ¥2,760)        | $0.552 (約 ¥8,280) |
| 15            | 150/150                  | 134,940        | 18,615         | 153,555    | $0.0314 (約 ¥4,710)        | $0.942 (約 ¥14,130) |
| 20            | 200/200                  | 179,920        | 24,820         | 204,740    | $0.0419 (約 ¥6,280)        | $1.257 (約 ¥18,855) |

### ケース2: 日本語記事10記事のみ

| RSSフィード数 | 取得記事数 (日本語) | 総入力トークン | 総出力トークン | 総トークン | 1日あたり総料金 (概算) | 月額総料金 (概算) |
| :------------ | :------------------ | :------------- | :------------- | :--------- | :----------------------- | :---------------- |
| 3             | 30                  | 6,363          | 1,323          | 7,686      | $0.0019 (約 ¥285)        | $0.057 (約 ¥855)  |
| 5             | 50                  | 10,605         | 2,205          | 12,810     | $0.0032 (約 ¥480)        | $0.096 (約 ¥1,440) |
| 10            | 100                 | 21,210         | 4,410          | 25,620     | $0.0064 (約 ¥960)        | $0.192 (約 ¥2,880) |
| 15            | 150                 | 31,815         | 6,615          | 38,430     | $0.0096 (約 ¥1,440)      | $0.288 (約 ¥4,320) |
| 20            | 200                 | 42,420         | 8,820          | 51,240     | $0.0128 (約 ¥1,920)      | $0.384 (約 ¥5,760) |

※総料金は1日あたりと、それを30日として換算した月額の概算です。
